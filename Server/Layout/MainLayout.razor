@using MVSRA.Server.Layout
@using MudBlazor

@inherits LayoutComponentBase

<MudThemeProvider @ref="_mudThemeProvider" Theme="@MVSRATheme" IsDarkMode="@_isDarkMode" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <Header @bind-DrawerOpen="@_drawerOpen" />
    <MudDrawer @bind-Open="@_drawerOpen">
        <NavMenu />
    </MudDrawer>
    <MudMainContent>
        <MudPaper Width="100%" Height="100%" MinHeight="500px">
            <MudContainer Class="pt-3 pb-3" MaxWidth="MaxWidth.Medium">
                @Body
            </MudContainer>
        </MudPaper>
        <Footer />
    </MudMainContent>
</MudLayout>

@code {
    private bool _drawerOpen = false;
    private bool _isDarkMode = false;
    private MudThemeProvider _mudThemeProvider = null!;

    private MudTheme MVSRATheme = new()
        {
            PaletteLight = new()
            {
                AppbarBackground = "#000000",
                AppbarText = "#FFCC33",
                DrawerBackground = "#000000",
                Primary = "#0052A7",
                Secondary = "#F0CA43",
                Background = "#FFFFFF"
            },
            PaletteDark = new()
            {
                AppbarBackground = "#FFFFFF",
                AppbarText = "#FFCC33",
                DrawerBackground = "#FFFFFF",
                Primary = "#0052A7",
                Secondary = "#F0CA43",
                Background = "#000000"
            }
        };

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            _isDarkMode = await _mudThemeProvider.GetSystemPreference();
            StateHasChanged();
        }
    }
}